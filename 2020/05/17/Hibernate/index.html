<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    
    <meta name="renderer" content="webkit"/>
    <meta name="force-rendering" content="webkit"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <script>if (/*@cc_on!@*/false || (!!window.MSInputMethodContext && !!document.documentMode)) window.location.href="https://support.dmeng.net/upgrade-your-browser.html?referrer="+encodeURIComponent(window.location.href); </script>
    
    
        <link rel="preload" crossorigin="crossorigin" href="/fonts/roboto/Roboto-Regular.woff2" as="font">
        <link rel="preload" crossorigin="crossorigin" href="/fonts/roboto/Roboto-Bold.woff2" as="font">
    
    
    
        <link rel="shortcut icon" href="/icons/favicon.ico">
    
    
    
<link rel="stylesheet" href="/css/mdui.min.css">
<link rel="stylesheet" href="/css/main.css">
<link rel="stylesheet" href="/css/iconfont.css">

    
    

    
        <script data-ad-client="ca-" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    












          


    
    
    <title>
        
            Hibernate | Dr.郑幸福
        
    </title>
<meta name="generator" content="Hexo 4.2.0"></head>
<body class="mdui-drawer-body-left mdui-appbar-with-toolbar mdui-theme-primary-blue-grey mdui-theme-accent-blue">
  
  <header class="mdui-appbar mdui-appbar-fixed">
  <div id="toolbar" class="mdui-toolbar mdui-color-theme">
    <button class="mdui-btn mdui-btn-icon" mdui-drawer="{target: '#sidebar', swipe: true}"><i class="iconfont icon-menu"></i></button>
    <a href="/" class="mdui-typo-headline">Dr.郑幸福</a>
    <a href="/" class="header-subtitle mdui-typo-headline"></a>
    <div class="mdui-toolbar-spacer"></div>
    <button class="mdui-btn mdui-btn-icon" mdui-dialog="{target: '#search'}" mdui-tooltip="{content: 'search'}"><i class="iconfont icon-search"></i></button>
  </div>
</header>

<div class="mdui-dialog" id="search">
  
    <div class="search-form">
      <input type="search" class="search-form-input" placeholder="请输入关键字" onfocus="listenSearchFunc()">
    </div>
    <div class="search-result" data-resource="/search.xml"></div>
  
</div>

  <aside id="sidebar" class="mdui-drawer">
    <div class="mdui-tab" mdui-tab>
        <a href="#sidebar-tab1" id="sidebartab" class="mdui-ripple mdui-tab-active">站点概览</a>
        <a href="#sidebar-tab2" id="sidebartab" class="mdui-ripple">关于</a>
    </div>

    
    <div id="sidebar-tab1" class="mdui-p-a-2">
        <div class="mdui-list">
            
                
                <a href="/" class="mdui-list-item mdui-ripple">
                    <div class="mdui-list-item-icon">
                        <i class="iconfont icon-home"></i>
                    </div>
                    <div class="mdui-list-item-content">主页</div>
                </a>
            
                
                <a href="/tags/" class="mdui-list-item mdui-ripple">
                    <div class="mdui-list-item-icon">
                        <i class="iconfont icon-bookmark"></i>
                    </div>
                    <div class="mdui-list-item-content">标签</div>
                </a>
            
                
                <a href="/categories/" class="mdui-list-item mdui-ripple">
                    <div class="mdui-list-item-icon">
                        <i class="iconfont icon-folder"></i>
                    </div>
                    <div class="mdui-list-item-content">分类</div>
                </a>
            
                
                <a href="/archives/" class="mdui-list-item mdui-ripple">
                    <div class="mdui-list-item-icon">
                        <i class="iconfont icon-archive"></i>
                    </div>
                    <div class="mdui-list-item-content">归档</div>
                </a>
            
            <div class="mdui-list-item mdui-ripple">
                <div class="mdui-list-item-icon">
                    <i class="iconfont icon-moon"></i>
                </div>
                <div class="mdui-list-item-content">夜间模式</div>
                <label class="mdui-switch" id="darkmode">
                  <input type="checkbox" id="nightmode_switch"/>
                  <i class="mdui-switch-icon"></i>
                </label>
            </div>           
        </div>
    </div>

    
    <div id="sidebar-tab2" class="mdui-p-a-2">
        <div class="sidebar-overview">
            <div class="sidebar-avatar">
                
                    <img src="/icons/avatar.gif"/>
                
            </div>
            <div class="sidebar-author-name">ZhengXingfu</div>
            <div class="sidebar-description"></div>
        </div>
        <div class="sidebar-links">
            
                
                <div class="mdui-chip">
                    <span class="mdui-chip-icon"><i class="iconfont icon-qq"></i></span>
                    <a href="/2385553537" class="mdui-chip-title">2385553537</a>
                </div>
            
                
                <div class="mdui-chip">
                    <span class="mdui-chip-icon"><i class="iconfont icon-wechat"></i></span>
                    <a href="/x182363%20%20" class="mdui-chip-title">x182363</a>
                </div>
            
                
                <div class="mdui-chip">
                    <span class="mdui-chip-icon"><i class="iconfont icon-mail"></i></span>
                    <a href="/Dr.Zicai@outlook.com" class="mdui-chip-title">Dr.Zicai@outlook.com</a>
                </div>
            
        </div>
        <ul class="mdui-list" mdui-collapse="{accordion: true}">
            <li class="mdui-collapse-item">
                <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
                    <div class="mdui-list-item-icon">
                        <i class="iconfont icon-link"></i>
                    </div>
                    <div class="mdui-list-item-content">友情链接</div>
                    <div class="mdui-collapse-item-arrow">
                        <i class="mdui-list-item-icon iconfont icon-angle-down"></i>
                    </div>
                </div>
                <ul class="mdui-collapse-item-body mdui-list mdui-list-dense">
                    
                        <a href="https://garybear.cn/hexo-theme-meadow/" target="_blank" rel="noopener" class="mdui-list-item mdui-ripple">
                            Meadow说明文档
                        </a>
                    
                </ul>
            </li>
        </ul>

    </div>

    <div class="mdui-divider"></div>
    
    
</aside>
  
  <main id="main-contain" class="mdui-container mdui-m-t-5">
    <article id="article" class="mdui-card mdui-p-b-2 mdui-m-b-5">
  <header class="mdui-card-media">
    
    
      <div class="post-header"> 
  <a class="post-header-title" href="/2020/05/17/Hibernate/">Hibernate</a>
  <div class="post-header-meta">
    <span>
      <span class="iconfont icon-calendar"></span>
      发布于:&nbsp;2020-05-17
    </span>
    <span>
      <span class="iconfont icon-calendar-check"></span>
      更新于:&nbsp;2020-05-25
    </span>
    <span>
      <span class="iconfont icon-folder"></span>
      分类于:&nbsp;<a class="category-link" href="/categories/java/">java</a>
    </span>
    
      <span>
        <span class="iconfont icon-eye"></span>
        阅读次数:&nbsp;
        <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv"></span></span>
      </span>
    
  </div>
</div>   
    



    
    
    <div class="mdui-card-menu">
    
      <button class="mdui-btn mdui-btn-icon mdui-text-color-teal" mdui-menu="{target: '#share_menu', align: 'right'}"><i class="iconfont icon-share"></i></button>
      <ul class="mdui-menu" id="share_menu">
        <li class="mdui-menu-item">
          <a href="http://service.weibo.com/share/share.php?appkey=&title=Hibernate&url=https://zhengxingfu.github.io/2020/05/17/Hibernate/&pic=https://ZhengXingfu.github.io/null&searchPic=false&style=simple" target="_blank" class="mdui-ripple">分享到 Weibo</a>
        </li>
        <li class="mdui-menu-item">
          <a href="https://twitter.com/intent/tweet?text=Hibernate&url=https://zhengxingfu.github.io/2020/05/17/Hibernate/&via=ZhengXingfu" target="_blank" class="mdui-ripple">分享到 Twitter</a>
        </li>
        <li class="mdui-menu-item">
          <a href="https://www.facebook.com/sharer/sharer.php?u=https://zhengxingfu.github.io/2020/05/17/Hibernate/" target="_blank" class="mdui-ripple">分享到 Facebook</a>
        </li>
        <li class="mdui-menu-item">
          <a href="https://plus.google.com/share?url=https://zhengxingfu.github.io/2020/05/17/Hibernate/" target="_blank" class="mdui-ripple">分享到 Google+</a>
        </li>
        <li class="mdui-menu-item">
          <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://zhengxingfu.github.io/2020/05/17/Hibernate/&title=Hibernate" target="_blank" class="mdui-ripple">分享到 LinkedIn</a>
        </li>
        <li class="mdui-menu-item">
          <a href="http://connect.qq.com/widget/shareqq/index.html?site=Dr.郑幸福&title=Hibernate&summary=&pics=https://ZhengXingfu.github.io/null&url=https://zhengxingfu.github.io/2020/05/17/Hibernate/" target="_blank" class="mdui-ripple">分享到 QQ</a>
        </li>
        <li class="mdui-menu-item">
          <a href="https://telegram.me/share/url?url=https://zhengxingfu.github.io/2020/05/17/Hibernate/&text=Hibernate" target="_blank" class="mdui-ripple">分享到 Telegram</a>
        </li>
      </ul>
    
  </div>
  </header>
  
  
  
  
  <div class="post-tags">
    
      <i class="iconfont icon-tag">
        <a rel="tag" href = /tags/%E6%A1%86%E6%9E%B6/ >框架</a>
      </i>
    
  </div>

  
  <div class="mdui-card-content mdui-typo mdui-p-x-4">
    <h3 id="Hibernate概述"><a href="#Hibernate概述" class="headerlink" title="Hibernate概述"></a>Hibernate概述</h3><blockquote>
<p>Hibernate框架是当今主流的Java持久层框架之一，由于它具有简单易学，灵活性强，扩展性强等特点，能够大大地简化程序代码量，提高工作效率，因此受到广大开发人员的喜爱。</p>
</blockquote>
<blockquote>
<p>Hibernate是一个开放源代码的ORM(Object Relational Mapping，对象关系映射)框架，它对JDBC进行了轻量级的对象封装，是的Java开发人员可以使用面向对象的编程思想来操作数据库。</p>
</blockquote>
<blockquote>
<p>Hibernate框架是应用在javaee三层结构中的dao层</p>
</blockquote>
<blockquote>
<p>在dao层里面做对数据库crud操作，使用hibernate实现crud操作，hibernate底层代码就是jdbc,hibernate对jdbc进行封装，使用hibernate好处，不需要写复杂的jdbc代码了，不需要写sql语句实现。</p>
</blockquote>
<h6 id="Hibernate版本："><a href="#Hibernate版本：" class="headerlink" title="Hibernate版本："></a>Hibernate版本：</h6><blockquote>
<p>Hibernate 3.x</p>
<p>Hibernate 4.x</p>
<p>Hibernate 5.x(学习)</p>
</blockquote>
<h6 id="什么是ORM思想"><a href="#什么是ORM思想" class="headerlink" title="什么是ORM思想"></a>什么是ORM思想</h6><p>1.hibernate使用orm思想对数据库进行crud操作</p>
<p>2.在web阶段学习javabean，正确的叫法 实体类</p>
<p>3.orm :object relational mapping, 对象关系映射</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//jdbc代码：</span></span><br><span class="line"><span class="comment">//加载驱动</span></span><br><span class="line">Class.forNAme(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line"><span class="comment">//创建连接</span></span><br><span class="line">Connection conn = DriverManager.getConnection(url,username,password);</span><br><span class="line"><span class="comment">//对sql进行预编译操作</span></span><br><span class="line">String sql=<span class="string">"select * from user"</span>;</span><br><span class="line">PreparedStatment psmt = conn.PrepareStatement(sql);</span><br><span class="line"><span class="comment">//执行sql查询sql</span></span><br><span class="line">ResultSet = pstm.executeQuery();</span><br><span class="line"><span class="comment">//遍历结果集</span></span><br><span class="line">……</span><br><span class="line"><span class="comment">//释放资源</span></span><br><span class="line">……</span><br></pre></td></tr></table></figure>

<h6 id="Hibernate入门"><a href="#Hibernate入门" class="headerlink" title="Hibernate入门"></a>Hibernate入门</h6><p>第一步：导入hibernate的jar包</p>
<p>第二步：创建一个实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> uid;</span><br><span class="line">	<span class="keyword">private</span> String username;</span><br><span class="line">	<span class="keyword">private</span> String password;</span><br><span class="line">	<span class="keyword">private</span> String address;</span><br></pre></td></tr></table></figure>

<p>（1）使用hibernate的是时候，不需要自己手动创建表，hibernate帮助创建表</p>
<p>第三步： 配置实体类和数据库表一一对应关系（映射关系）</p>
<p>使用配置文件实现映射关系</p>
<p>（1）创建xml格式的配置文件</p>
<p>–映射配置文件名称和配置没有固定要求</p>
<p>–建议：在实体类所在的包里创建，实体类名称：hbm.xml</p>
<p>（2）配置是xml的格式，在配置文件中首先引入xml约束（dtd约束）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span> </span></span><br><span class="line"><span class="meta">    <span class="meta-string">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>(3)配置映射关系</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--  1.配置类和表对应</span></span><br><span class="line"><span class="comment"> 	class标签</span></span><br><span class="line"><span class="comment"> 	name属性：实体类全路径</span></span><br><span class="line"><span class="comment"> 	table属性：数据库表的名称</span></span><br><span class="line"><span class="comment">	--&gt;</span>   </span><br><span class="line">	<span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">"cn.itcast.entity.User"</span> <span class="attr">table</span>=<span class="string">"tb_user"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--2.配置实体类id和表id对应  </span></span><br><span class="line"><span class="comment">    	hibernate要求实体类有一个属性唯一值</span></span><br><span class="line"><span class="comment">    	hibernate要求表有字段作为唯一值</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- id 标签</span></span><br><span class="line"><span class="comment">    	name属性：实体类里面id属性名称</span></span><br><span class="line"><span class="comment">    	column属性：生成表字段名称</span></span><br><span class="line"><span class="comment">     --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"uid"</span> <span class="attr">column</span>=<span class="string">"uid"</span>&gt;</span></span><br><span class="line">    	<span class="comment">&lt;!--设置id增长策略 </span></span><br><span class="line"><span class="comment">    		native属性：生成表id值就是主键自动增长</span></span><br><span class="line"><span class="comment">    	  --&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span><span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置其他属性和表的字段的对应 </span></span><br><span class="line"><span class="comment">    	name属性：实体类属性名称</span></span><br><span class="line"><span class="comment">    	column属性：生成表字段名称</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">column</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">column</span>=<span class="string">"password"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"address"</span> <span class="attr">column</span>=<span class="string">"address"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>第四步：创建hibernate的核心配置文件</p>
<p>（1） 核心配置文件的格式xml,但是核心配置文件名称和位置是固定的</p>
<blockquote>
<p>位置：src下面</p>
</blockquote>
<blockquote>
<p>名称：hibernate.cfg.xml</p>
</blockquote>
<p>（2）引入约束</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-configuration</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">	<span class="meta-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span></span></span><br><span class="line"><span class="meta">	<span class="meta-string">"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>（3）hibernate操过程中，只会加载里面的核心配置文件，其他的配置文件不会加载。</p>
<p>第一部分：配置数据库信息</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql:///hibernate_day01<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.connection.username"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.connection.password"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>第二部分：配置hibernate信息</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--输出底层的sql语句  --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--对输出sql语句 格式化 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.format_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- hibernate 帮助创建表，需要配置之后</span></span><br><span class="line"><span class="comment">		update： 如果已经有表，更新；没有表，创建</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.hbm2ddl.auto"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 数据库方言</span></span><br><span class="line"><span class="comment">			在mysql里面实现分页 关键字limit,只能使用mysql里面;</span></span><br><span class="line"><span class="comment">			在Oracle数据库，实现分页rownum;</span></span><br><span class="line"><span class="comment">			不同的数据库中,sql语法略有区别. 指定方言可以让hibernate框架在生成sql语句时.针对数据库的方言生成.</span></span><br><span class="line"><span class="comment">			sql99标准: DDL 定义语言  库表的增删改查</span></span><br><span class="line"><span class="comment">					  DCL 控制语言  事务 权限</span></span><br><span class="line"><span class="comment">					  DML 操纵语言  增删改查</span></span><br><span class="line"><span class="comment">			注意: MYSQL在选择方言时,请选择最短的方言.</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>第三部分：把映射文件放到核心配置文件中</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"cn/itcast/entity/User.hbm.xml"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h6 id="实现添加操作"><a href="#实现添加操作" class="headerlink" title="实现添加操作"></a>实现添加操作</h6><p>第一步 加载hibernate核心配置文件</p>
<p>第二步 创建SessionFactory对象</p>
<p>第三步 使用SessionFactory创建session对象</p>
<p>第四步 开启事务</p>
<p>第五步 写具体逻辑crud操作</p>
<p>第六步 提交事务</p>
<p>第七步 关闭资源</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.hibernatetest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Transaction;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.itcast.entity.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HibernateDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAdd</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line"><span class="comment">//		第一步 加载hibernate核心配置文件</span></span><br><span class="line">			<span class="comment">//在hibernate里面封装对象  到src下面找到名称是 hibernate.cfh.xml文件</span></span><br><span class="line">		Configuration cfg = <span class="keyword">new</span> Configuration();</span><br><span class="line">		cfg.configure();</span><br><span class="line">		</span><br><span class="line"><span class="comment">//		第二步 创建SessionFactory对象</span></span><br><span class="line">		<span class="comment">//读取hibernate核心配置文件内容，创建sessionFactory</span></span><br><span class="line">		<span class="comment">//在过程中，根据映射关系，在配置数据库里面把表创建</span></span><br><span class="line">		SessionFactory sessionFactory = cfg.buildSessionFactory();</span><br><span class="line">		</span><br><span class="line"><span class="comment">//		第三步 使用SessionFactory创建session对象</span></span><br><span class="line">		<span class="comment">//类似域连接</span></span><br><span class="line">		Session session = sessionFactory.openSession();</span><br><span class="line"><span class="comment">//		第四步 开启事务</span></span><br><span class="line">		 Transaction tx = session.beginTransaction();</span><br><span class="line"><span class="comment">//		第五步 写具体逻辑crud操作</span></span><br><span class="line">		 <span class="comment">//添加的功能</span></span><br><span class="line">		 User user= <span class="keyword">new</span> User();</span><br><span class="line">		 user.setUsername(<span class="string">"蜘蛛侠"</span>);</span><br><span class="line">		 user.setPassword(<span class="string">"520520"</span>);</span><br><span class="line">		 user.setAddress(<span class="string">"荷兰"</span>);</span><br><span class="line">		 <span class="comment">//调用session对象</span></span><br><span class="line">		 session.save(user);</span><br><span class="line">		 </span><br><span class="line"><span class="comment">//		第六步 提交事务</span></span><br><span class="line">		 tx.commit();</span><br><span class="line"><span class="comment">//		第七步 关闭资源</span></span><br><span class="line">		session.close();</span><br><span class="line">		sessionFactory.close();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看到效果</p>
<blockquote>
<p>是否添加表</p>
</blockquote>
<blockquote>
<p>是否有记录</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Hibernate: </span><br><span class="line">    insert </span><br><span class="line">    into</span><br><span class="line">        tb_user</span><br><span class="line">        (username, password, address) </span><br><span class="line">    values</span><br><span class="line">        (?, ?, ?)</span><br></pre></td></tr></table></figure>

<h5 id="Hibernate配置文件详解"><a href="#Hibernate配置文件详解" class="headerlink" title="Hibernate配置文件详解"></a>Hibernate配置文件详解</h5><h6 id="Hibernate映射配置文件"><a href="#Hibernate映射配置文件" class="headerlink" title="Hibernate映射配置文件"></a>Hibernate映射配置文件</h6><ol>
<li><p>映射配置文件名称和位置没有固定要求</p>
</li>
<li><p>映射配置文件中，标签name属性值写实体类相关内容</p>
</li>
</ol>
<blockquote>
<p>（1）class标签name属性值实体类全路径</p>
</blockquote>
<blockquote>
<p>（2）id标签和property标签name属性值实体类属性名称</p>
</blockquote>
<ol start="3">
<li><p>id 标签和property标签， column属性可以省略的</p>
<p>（1）不写值和name属性值一样的</p>
</li>
<li><p>property标签和type属性，设置生成字段类型的，自动对应类型</p>
</li>
</ol>
<h6 id="Hibernate核心配置文件"><a href="#Hibernate核心配置文件" class="headerlink" title="Hibernate核心配置文件"></a>Hibernate核心配置文件</h6><p>1.配置位置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2.配置要求</p>
<blockquote>
<p>​    数据库</p>
</blockquote>
<blockquote>
<p>​    Hibernate</p>
</blockquote>
<blockquote>
<p>​    映射文件路径</p>
</blockquote>
<p>3.核心配置文件名称和位置是固定的</p>
<blockquote>
<p>位置：src下面</p>
</blockquote>
<blockquote>
<p>名称：hibernate.cfg.xml</p>
</blockquote>
<h5 id="Hibernate-核心api"><a href="#Hibernate-核心api" class="headerlink" title="Hibernate 核心api"></a>Hibernate 核心api</h5><h6 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h6><p>1.代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Configuration cfg = <span class="keyword">new</span> Configuration();</span><br><span class="line">	cfg.configure();</span><br></pre></td></tr></table></figure>

<p>(1) 到src下面找到名称hibernate.xml配置文件，创建对象，把配置文件放到对象里面（加载核心配置文件）</p>
<h6 id="SessionFactory"><a href="#SessionFactory" class="headerlink" title="SessionFactory"></a>SessionFactory</h6><p>1.使用configuration对象创建sessionFactory对象</p>
<p>（1）创建sessionfactory过程中做的事情</p>
<blockquote>
<p>根据核心配置文件中，有数据库配置，有映射文件部分，到数据库里面根据映射关系把表创建</p>
</blockquote>
<p><code>&lt;property name=&quot;hibernate.hbm2ddl.auto&quot;&gt;update&lt;/property&gt;</code></p>
<p>2.创建sessionFactory过程中，这个过程特别耗资源</p>
<p>（1）在hibernate操作中，建议一个项目一般创建一个sessionFactory对象</p>
<p>3.具体实现：</p>
<p>（1）写工具类，写静态代码块实现</p>
<blockquote>
<p>静态代码块在类加载时候执行，执行一次</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.itcast.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HibernateUtils</span> </span>&#123;</span><br><span class="line">	<span class="keyword">static</span> Configuration cfg = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">static</span> SessionFactory sessionFactory = <span class="keyword">null</span>;</span><br><span class="line">	<span class="comment">//静态代码块实现</span></span><br><span class="line">	<span class="keyword">static</span> &#123;</span><br><span class="line">		<span class="comment">//加载核心配置文件</span></span><br><span class="line">		cfg = <span class="keyword">new</span> Configuration();</span><br><span class="line">		cfg.configure();</span><br><span class="line">		sessionFactory = cfg.buildSessionFactory();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//提供方法返回sessionFActory</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SessionFactory <span class="title">getSessionFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> sessionFactory;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h6><p>1.session类似于jdbc中的connection</p>
<p>2.调用session里面不同的方法实现crud操作</p>
<blockquote>
<p>添加save方法</p>
</blockquote>
<blockquote>
<p>修改update方法</p>
</blockquote>
<blockquote>
<p>删除delete方法</p>
</blockquote>
<blockquote>
<p>根据id查询get方法</p>
</blockquote>
<h6 id="实体类的编写规则："><a href="#实体类的编写规则：" class="headerlink" title="实体类的编写规则："></a>实体类的编写规则：</h6><ol>
<li><p>实体类里面属性是私有的</p>
</li>
<li><p>私有属性使用公开的get和set方法</p>
</li>
<li><p>要求实体类有属性作为唯一值</p>
</li>
<li><p>实体类里面的属性建议不使用基本数据类型，使用基本数据类型对应的包装类</p>
<p>（1）八个基本数据类型对应的包装类</p>
<p>-int - Integer</p>
<p>-char - Character</p>
<p>-其他的都是首字母大写 比如 double - Double</p>
<p>(2)比如表示学生的分数，假如 int score:</p>
<p>​    -比如学生的了0分, int score = 0;</p>
<p>​    -如果表示学生没有参加考试， int score = 0;不能准确表示学生是否参加考试</p>
<blockquote>
<p>解决：使用包装类就可以了， Integer score=0, 表示学生得了零分； Interger score = null，表示学生没有参加考试。</p>
</blockquote>
</li>
</ol>
<h6 id="Hibernate-主键生成策略"><a href="#Hibernate-主键生成策略" class="headerlink" title="Hibernate 主键生成策略"></a>Hibernate 主键生成策略</h6><p>1.hibernate 要求实体类里面有一个属性作为唯一值，对应表主键，主键可以不同生成策略</p>
<p>2.hibernate主键生成策略</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">"uid"</span> <span class="attr">column</span>=<span class="string">"uid"</span>&gt;</span></span><br><span class="line">  	<span class="comment">&lt;!--设置id增长策略 </span></span><br><span class="line"><span class="comment">  		native属性：生成表id值就是主键自动增长</span></span><br><span class="line"><span class="comment">  	  --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">"native"</span>&gt;</span><span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>native ：根据使用的数据库帮选择那个值</p>
</blockquote>
<blockquote>
<p>uuid（字符串类型）: 之前web阶段 写代码生成uuid值，hibernate帮我们生成uuid值</p>
</blockquote>
<h5 id="实体类操作"><a href="#实体类操作" class="headerlink" title="实体类操作"></a>实体类操作</h5><h6 id="对实体类的crud操作"><a href="#对实体类的crud操作" class="headerlink" title="对实体类的crud操作"></a>对实体类的crud操作</h6><blockquote>
<p>添加操作</p>
</blockquote>
<p>1.调用session里面的save操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//添加的功能</span></span><br><span class="line"> User user= <span class="keyword">new</span> User();</span><br><span class="line"> user.setUsername(<span class="string">"黑寡妇"</span>);</span><br><span class="line"> user.setPassword(<span class="string">"520520"</span>);</span><br><span class="line"> user.setAddress(<span class="string">"不知道"</span>);</span><br><span class="line"> <span class="comment">//调用session对象</span></span><br><span class="line"> session.save(user);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>根据id查询</p>
<p>1.调用session里面的get方法操作</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//1 调用工具类得到SessionFactory</span></span><br><span class="line">		SessionFactory sessionFactory = HibernateUtils.getSessionFactory();</span><br><span class="line">		<span class="comment">//2 获取session</span></span><br><span class="line">		Session session =  sessionFactory.openSession();</span><br><span class="line">		<span class="comment">// 3 开启事务</span></span><br><span class="line">		Transaction tx = session.beginTransaction();</span><br><span class="line">		<span class="comment">//4 根据id查询</span></span><br><span class="line">		<span class="comment">//调用session里面的get方法</span></span><br><span class="line">		<span class="comment">// 第一个参数：实体类的class</span></span><br><span class="line">		<span class="comment">//第二个参数： id 值</span></span><br><span class="line">		User user = session.get(User<span class="class">.<span class="keyword">class</span>, 2)</span>;</span><br><span class="line">		System.out.println(user);</span><br><span class="line">		<span class="comment">//5 提交事务</span></span><br><span class="line">		tx.commit();</span><br><span class="line">		<span class="comment">//6 关闭</span></span><br><span class="line">		session.close();</span><br><span class="line">		sessionFactory.close();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>修改操作</p>
</blockquote>
<ol>
<li>首先查询，再修改值，</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//1 调用工具类得到SessionFactory</span></span><br><span class="line">	SessionFactory sessionFactory = HibernateUtils.getSessionFactory();</span><br><span class="line">	<span class="comment">//2 获取session</span></span><br><span class="line">	Session session =  sessionFactory.openSession();</span><br><span class="line">	<span class="comment">// 3 开启事务</span></span><br><span class="line">	Transaction tx = session.beginTransaction();</span><br><span class="line">	<span class="comment">//4.修改操作</span></span><br><span class="line">	<span class="comment">//修改uid=2记录username 的值</span></span><br><span class="line">	<span class="comment">//4.1 根据id 查询</span></span><br><span class="line">	User user = session.get(User<span class="class">.<span class="keyword">class</span>, 2)</span>;</span><br><span class="line">	<span class="comment">//4.2 向返回的user对象里面设置修改之后的值</span></span><br><span class="line">	user.setUsername(<span class="string">"洪金宝"</span>);</span><br><span class="line">	<span class="comment">//4.3 调用session的方法里面update修改</span></span><br><span class="line">	session.update(user);</span><br><span class="line">	System.out.println(user);</span><br><span class="line">	<span class="comment">//5 提交事务</span></span><br><span class="line">	tx.commit();</span><br><span class="line">	<span class="comment">//6 关闭</span></span><br><span class="line">	session.close();</span><br><span class="line">	sessionFactory.close();</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>删除操作</p>
</blockquote>
<p>1.调用session 里面的delete方法实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">		<span class="comment">//4.删除操作</span></span><br><span class="line">		<span class="comment">//第一种方式 根据id查询对象</span></span><br><span class="line"><span class="comment">//		User user = session.get(User.class, 1);</span></span><br><span class="line"><span class="comment">//		session.delete(user);</span></span><br><span class="line">		<span class="comment">//第二种方式 </span></span><br><span class="line">			User user = <span class="keyword">new</span> User();</span><br><span class="line">			user.setUid(<span class="number">2</span>);</span><br><span class="line">			session.delete(user);</span><br></pre></td></tr></table></figure>

<h6 id="实体类对象状态（概念）"><a href="#实体类对象状态（概念）" class="headerlink" title="实体类对象状态（概念）"></a>实体类对象状态（概念）</h6><blockquote>
<p>1.实体类的状态有三种</p>
<p>（1）瞬时态：对象里面没有id值，对象跟session没有关系</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> User user= <span class="keyword">new</span> User();</span><br><span class="line">user.setUsername(<span class="string">"黑寡妇"</span>);</span><br><span class="line">user.setPassword(<span class="string">"520520"</span>);</span><br><span class="line">user.setAddress(<span class="string">"不知道"</span>);</span><br><span class="line"><span class="comment">//调用session对象</span></span><br><span class="line">session.save(user);</span><br></pre></td></tr></table></figure>

<p>（2）持久态：对象里面有id值，与session有关联</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User user = session.get(User<span class="class">.<span class="keyword">class</span>, 2)</span>;</span><br></pre></td></tr></table></figure>

<p>（3）托管态：对象有id值，对象与session没有关联</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User user = <span class="keyword">new</span> User();</span><br><span class="line">user.setUid(<span class="number">2</span>);</span><br></pre></td></tr></table></figure>
</blockquote>
<p>2.操作实体类对象的方法</p>
<p>（1）saveOrUpdate方法：实现添加，实现修改；</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//4.添加操作</span></span><br><span class="line"><span class="comment">// 瞬时态做保存</span></span><br><span class="line"><span class="comment">// 实体类对象是托管态， 做修改</span></span><br><span class="line">	User user = <span class="keyword">new</span> User();</span><br><span class="line">	user.setUid(<span class="number">4</span>);</span><br><span class="line">	user.setUsername(<span class="string">"刘德华"</span>);</span><br><span class="line">	user.setPassword(<span class="string">"7895465321"</span>);</span><br><span class="line">	user.setAddress(<span class="string">"不晓得"</span>);</span><br><span class="line">	</span><br><span class="line">	session.saveOrUpdate(user);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;对象是持久态 ， 也能做修改</span><br><span class="line">User user&#x3D; session.get(User.class, 4);</span><br><span class="line">user.setAddress(&quot;台湾&quot;);</span><br><span class="line">session.saveOrUpdate(user);</span><br></pre></td></tr></table></figure>

<h5 id="Hibernate-的一级的缓存"><a href="#Hibernate-的一级的缓存" class="headerlink" title="Hibernate 的一级的缓存"></a>Hibernate 的一级的缓存</h5><blockquote>
<h6 id="什么是缓存？"><a href="#什么是缓存？" class="headerlink" title="什么是缓存？"></a>什么是缓存？</h6><p>1.数据存到数据库里面，数据库本身是文件系统，使用流方式操作文件效率不是很高。</p>
<p>（1）把数据存到内存里面，不需要使用流的方式，就可以直接读取内存的数据</p>
<p>（2）把数据放到内存中，提供读取效率</p>
</blockquote>
<h6 id="Hibernate缓存"><a href="#Hibernate缓存" class="headerlink" title="Hibernate缓存"></a>Hibernate缓存</h6><p>1.Hibernate框架中提供很多优化方式， hibernate的缓存就是一个优化方式</p>
<p>2.hibernate缓存的特点：</p>
<blockquote>
<p>第一类 hibernate一级缓存</p>
</blockquote>
<p>（1）hibernate 的一级缓存时默认打开的，</p>
<p>（2）hibernate的一级缓存使用范围，是session范围，从session创建到session关闭范围</p>
<p>（3）hibernate的一级缓存中，存储数据必须是持久态数据</p>
<blockquote>
<p>第二类 hibernate二级缓存</p>
</blockquote>
<p>（1）目前已经不使用了，替代技术redis </p>
<p>（2）二级缓存默认不是打开的，需要配置</p>
<p>（3）二级缓存适用范围：是sessionFactory范围</p>
<h5 id="Hibernate事务操作"><a href="#Hibernate事务操作" class="headerlink" title="Hibernate事务操作"></a>Hibernate事务操作</h5><h6 id="事务相关概念"><a href="#事务相关概念" class="headerlink" title="事务相关概念"></a>事务相关概念</h6><p>1.什么是事务</p>
<p>2.事务特性</p>
<p>3.不考虑隔离性产生问题</p>
<p>（1）脏读</p>
<p>（2）不可重复读</p>
<p>（3）虚读</p>
<p>4.设置事务隔离级别</p>
<h6 id="Hibernate事务代码规范写法"><a href="#Hibernate事务代码规范写法" class="headerlink" title="Hibernate事务代码规范写法"></a>Hibernate事务代码规范写法</h6><p>1.代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">	开启事务</span><br><span class="line">	提交事务</span><br><span class="line">&#125;<span class="keyword">catch</span>&#123;</span><br><span class="line">	回滚事务</span><br><span class="line">&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">	关闭操作</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testTx</span><span class="params">()</span></span>&#123;</span><br><span class="line">		SessionFactory sessionFactory = <span class="keyword">null</span>;</span><br><span class="line">		Session session = <span class="keyword">null</span>;</span><br><span class="line">		Transaction tx = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			sessionFactory = HibernateUtils.getSessionFactory();</span><br><span class="line">			session = sessionFactory.openSession();</span><br><span class="line">			<span class="comment">//开启事务</span></span><br><span class="line">			tx = session.beginTransaction();</span><br><span class="line">			<span class="comment">//添加</span></span><br><span class="line">			User user = <span class="keyword">new</span> User();</span><br><span class="line">			user.setUsername(<span class="string">"张飞"</span>);</span><br><span class="line">			user.setPassword(<span class="string">"45654465"</span>);</span><br><span class="line">			user.setAddress(<span class="string">"北京"</span>);</span><br><span class="line">			session.save(user);</span><br><span class="line">			</span><br><span class="line">		</span><br><span class="line">			<span class="comment">//提交事务</span></span><br><span class="line">			</span><br><span class="line">			tx.commit();</span><br><span class="line">		&#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">			</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">			session.close();</span><br><span class="line">			sessionFactory.close();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h6 id="Hibernate绑定session"><a href="#Hibernate绑定session" class="headerlink" title="Hibernate绑定session"></a>Hibernate绑定session</h6><p>1.session类似与jdbc的connection, 之前web阶段学过threadLocal</p>
<p>2.帮助实现与本地线程绑定session</p>
<p>3.获取与本地线程session</p>
<p>（1）在hibernate核心配置文件中配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 绑定session 的本地线程 </span></span><br><span class="line"><span class="comment">	thread：Session对象的生命周期与本地线程绑定</span></span><br><span class="line"><span class="comment">	jta: Session对象的生命周期与JTA事务绑定</span></span><br><span class="line"><span class="comment">	manage：Hibernate委托程序来管理session对象的生命周期</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hibernate.current_session_context_class"</span>&gt;</span>thread<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>（2）调用sessionFactory里面的方法得到</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//提供返回与本地线程帮的session方法</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Session <span class="title">getSessionobject</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> sessionFactory.getCurrentSession();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>4.获取与本地线程绑定session 的时候。关闭session报错， 不需要手动关闭了！</p>
<h5 id="Hibernate的api使用"><a href="#Hibernate的api使用" class="headerlink" title="Hibernate的api使用"></a>Hibernate的api使用</h5><h6 id="Query对象"><a href="#Query对象" class="headerlink" title="Query对象"></a>Query对象</h6><p>1.使用query对象，不需要写slq语句，但是写hql语句</p>
<p>（1）hql：hibernate query language，hibernate提供查询语言，这个hql语句很相似</p>
<p>（2）hql 和sql 语句区别：</p>
<p>​            使用sql操作表和表字段</p>
<p>​            使用hql操作实体类和属性</p>
<p>2.查询所有hql语句</p>
<p>（1）from 实体类名称</p>
<p>3.Query对象的使用：</p>
<p>（1）创建Query对象</p>
<p>（2）调用query对象里面的方法得到结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testTx</span><span class="params">()</span></span>&#123;</span><br><span class="line">		SessionFactory sessionFactory = <span class="keyword">null</span>;</span><br><span class="line">		Session session = <span class="keyword">null</span>;</span><br><span class="line">		Transaction tx = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">//			//本地线程绑定的session</span></span><br><span class="line"><span class="comment">//			session= HibernateUtils.getSessionobject();</span></span><br><span class="line">			sessionFactory = HibernateUtils.getSessionFactory();</span><br><span class="line">			session=sessionFactory.openSession();</span><br><span class="line">			<span class="comment">//开启事务</span></span><br><span class="line">			tx = session.beginTransaction();</span><br><span class="line">		</span><br><span class="line">			<span class="comment">//1.创建Query 对象</span></span><br><span class="line">			Query query = session.createQuery(<span class="string">"from User"</span>);</span><br><span class="line">			<span class="comment">//2.调用query对象里面的方法得到结果</span></span><br><span class="line">			List&lt;User&gt; list = query.list();</span><br><span class="line">			<span class="keyword">for</span>(User user:list) &#123;</span><br><span class="line">				System.out.println(user);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//提交事务			</span></span><br><span class="line">			tx.commit();</span><br><span class="line">		&#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">			</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">			session.close();</span><br><span class="line">			sessionFactory.close();</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<h6 id="Criteria对象"><a href="#Criteria对象" class="headerlink" title="Criteria对象"></a>Criteria对象</h6><p>1.使用这个对象查询操作，但是使用对象的时候，不需要写语句，直接调用方法实现</p>
<p>2.实现过程：</p>
<p>（1）创建Criteria对象</p>
<p>（2）调用方法得到结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建Query 对象</span></span><br><span class="line">		Query query = session.createQuery(<span class="string">"from User"</span>);</span><br><span class="line">		<span class="comment">//2.调用query对象里面的方法得到结果</span></span><br><span class="line">		List&lt;User&gt; list = query.list();</span><br><span class="line">		<span class="keyword">for</span>(User user:list) &#123;</span><br><span class="line">			System.out.println(user);</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<h6 id="SQLQuery对象"><a href="#SQLQuery对象" class="headerlink" title="SQLQuery对象"></a>SQLQuery对象</h6><p>1.使用hibernate的时候， 调用底层sql实现</p>
<p>2.实现过程</p>
<p>（1）创建对象</p>
<p>（2）调用对象方法得到结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建SQLQuery对象</span></span><br><span class="line">		SQLQuery sqlquery = session.createSQLQuery(<span class="string">"select * from tb_user"</span>);</span><br><span class="line">		<span class="comment">//2.调用方法得到结果</span></span><br><span class="line">		<span class="comment">//返回list集合， 默认里面每部分数据结构</span></span><br><span class="line">		List&lt;Object[]&gt; list = sqlquery.list();</span><br><span class="line">		<span class="keyword">for</span>(Object[] objects:list) &#123;</span><br><span class="line">			System.out.println(Arrays.toString(objects));</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>返回list中每部分是对象：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建SQLQuery对象</span></span><br><span class="line">			SQLQuery sqlquery = session.createSQLQuery(<span class="string">"select * from tb_user"</span>);</span><br><span class="line">			<span class="comment">//2.调用方法得到结果</span></span><br><span class="line">			sqlquery.addEntity(User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">			List&lt;User&gt; list = sqlquery.list();</span><br><span class="line">			<span class="keyword">for</span>(User user:list) &#123;</span><br><span class="line">				System.out.println(user);</span><br><span class="line">			&#125;</span><br></pre></td></tr></table></figure>

</blockquote>
<blockquote>
<h6 id="表与表之间的关系"><a href="#表与表之间的关系" class="headerlink" title="表与表之间的关系"></a>表与表之间的关系</h6><blockquote>
<p>1.一对多：一对多建表，通过外键建立联系</p>
</blockquote>
<p>（1）分类和商品关系，一个分类里面有多个商品，一个商品只能属于一个分类</p>
<p>（2）客户联系人是一对多的关系</p>
<p>​        客户：与公司有业务往来，百度、新浪、360</p>
<p>​        联系人：公司里边的员工，百度里面有很多的员工</p>
<p>​        公司和公司员工的关系</p>
<blockquote>
<p>2.多对多：建立第三张表来维持关系（至少有两个字段做 为外键）</p>
</blockquote>
<p>（1）订单和商品的关系，一个订单里面有多个商品，一个商品属于多的订单</p>
<p>（2）用户和角色多对多关系</p>
<blockquote>
<p>3.一对一</p>
</blockquote>
<p>（1）用的较少，</p>
</blockquote>
<h5 id="Hibernate的一对多操作"><a href="#Hibernate的一对多操作" class="headerlink" title="Hibernate的一对多操作"></a>Hibernate的一对多操作</h5><h6 id="一对多映射配置"><a href="#一对多映射配置" class="headerlink" title="一对多映射配置"></a>一对多映射配置</h6><p>第一步：创建两个实体类， 客户和联系人</p>
<p>第二步：让两个实体类之间相互表示</p>
<blockquote>
<p>（1）在客户实体类里面表示多个联系人</p>
<p>​        一个客户里面有多个联系人</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//hibernate要求使用集合表示多的数据，使用set集合</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> Set&lt;LinkMan&gt; setLinkMan = <span class="keyword">new</span> HashSet&lt;LinkMan&gt;();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Set&lt;LinkMan&gt; <span class="title">getSetLinkMan</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> setLinkMan;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSetLinkMan</span><span class="params">(Set&lt;LinkMan&gt; setLinkMan)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.setLinkMan = setLinkMan;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>（2）在联系人实体类里面表示所属客户</p>
<p>​        一个联系人只能属于一个客户</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在联系人实体类里面表示所属客户   ,一个联系人只能属于一个客户</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> Customer customer;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Customer <span class="title">getCustomer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> customer;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCustomer</span><span class="params">(Customer customer)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.customer = customer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>第三步：配置映射关系</p>
<p>（1）一般一个实体类对应一个映射文件</p>
<p>（2）把映射文件的基本的配置完成</p>
<p>（3）在映射文件中，配置一对多的关系</p>
<p>​        -在客户映射文件中， 表示所有联系人</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 在客户映射文件中 ， 表示所有联系人</span></span><br><span class="line"><span class="comment">  	使用set标签表示所有联系人</span></span><br><span class="line"><span class="comment">  	set标签里面有name属性：</span></span><br><span class="line"><span class="comment">  		属性值写在客户实体类里面表示联系人的set集合名称</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"setLinkMan"</span>&gt;</span></span><br><span class="line">  		<span class="comment">&lt;!--一对多建表，都有外键</span></span><br><span class="line"><span class="comment">  			hibernate机制，双向维护外键，在一和多的哪一方都配置外键</span></span><br><span class="line"><span class="comment">  		  --&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"clid"</span>&gt;</span><span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">  		<span class="comment">&lt;!--  客户所有的联系人， class里面写联系人实体类全路径--&gt;</span></span><br><span class="line">  		<span class="tag">&lt;<span class="name">one-to-many</span> <span class="attr">class</span>=<span class="string">"cn.itcast.entity.LinkMan"</span>/&gt;</span></span><br><span class="line">  	<span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​    -在联系人映射文件中，表示所属客户</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- -在联系人映射文件中，表示所属客户 </span></span><br><span class="line"><span class="comment">   	name属性：因为在联系人实体类使用customer对象表示，写customer名称</span></span><br><span class="line"><span class="comment">   	class属性：customer全路径</span></span><br><span class="line"><span class="comment">   	column属性：外键名称</span></span><br><span class="line"><span class="comment">   --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">many-to-one</span> <span class="attr">name</span>=<span class="string">"customer"</span> <span class="attr">class</span>=<span class="string">"cn.itcast.entity.Customer"</span> <span class="attr">column</span>=<span class="string">"clid"</span>&gt;</span><span class="tag">&lt;/<span class="name">many-to-one</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>第四步：创建核心配置文件，引入映射文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 第三部分：把映射文件放到核心配置文件中  必须--&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;mapping resource&#x3D;&quot;&#x2F;hibernate_day03&#x2F;src&#x2F;cn&#x2F;itcast&#x2F;entity&#x2F;Customer.hbm.xml&quot;&#x2F;&gt;</span><br><span class="line">	&lt;mapping resource&#x3D;&quot;&#x2F;hibernate_day03&#x2F;src&#x2F;cn&#x2F;itcast&#x2F;entity&#x2F;LinkMan.hbm.xml&quot;&#x2F;&gt;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Hibernate: </span><br><span class="line">    create table tb_customer (</span><br><span class="line">        cid integer not null auto_increment,</span><br><span class="line">        custName varchar(255),</span><br><span class="line">        custLevel varchar(255),</span><br><span class="line">        custSource varchar(255),</span><br><span class="line">        custPhone varchar(255),</span><br><span class="line">        custMbile varchar(255),</span><br><span class="line">        primary key (cid)</span><br><span class="line">    )</span><br><span class="line">Hibernate: </span><br><span class="line">    create table tb_linkman (</span><br><span class="line">        lkm_id integer not null auto_increment,</span><br><span class="line">        lkm_name varchar(255),</span><br><span class="line">        lkm_gender varchar(255),</span><br><span class="line">        lkm_phone varchar(255),</span><br><span class="line">        clid integer,</span><br><span class="line">        primary key (lkm_id)</span><br><span class="line">    )</span><br><span class="line">Hibernate: </span><br><span class="line">    alter table tb_linkman </span><br><span class="line">        add constraint FKl2iyisbrbk3i34ir9r27ce4ip </span><br><span class="line">        foreign key (clid) </span><br><span class="line">        references tb_customer (cid)</span><br></pre></td></tr></table></figure>

<h6 id="一对多级联操作"><a href="#一对多级联操作" class="headerlink" title="一对多级联操作"></a>一对多级联操作</h6><blockquote>
<p>级联操作</p>
<ol>
<li><p>级联保存</p>
<p>（1）添加一个客户，为这个客户添加多个联系人</p>
</li>
<li><p>级联删除</p>
<p>（1）删除某一个客户，这个客户里面的所有联系人也删除</p>
</li>
</ol>
</blockquote>
<h6 id="一对多的级联保存"><a href="#一对多的级联保存" class="headerlink" title="一对多的级联保存"></a>一对多的级联保存</h6><ol>
<li><p>添加客户，为这个客户添加一个联系人</p>
<p>（1）复杂写法</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span><span class="comment">//（复杂写法）</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAddDemo1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		SessionFactory sessionFactory = <span class="keyword">null</span>;</span><br><span class="line">		Session session = <span class="keyword">null</span>;</span><br><span class="line">		Transaction tx = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//得到sessionfactory</span></span><br><span class="line">			sessionFactory = HibernateUtils.getSessionFactory();</span><br><span class="line">			<span class="comment">//本地线程绑定的session</span></span><br><span class="line">			session = sessionFactory.openSession();</span><br><span class="line">			<span class="comment">//开启事务</span></span><br><span class="line">			tx = session.beginTransaction();</span><br><span class="line">			<span class="comment">//添加</span></span><br><span class="line">		<span class="comment">//添加一个客户，为这个客户添加一个联系人</span></span><br><span class="line">			<span class="comment">//1.创建客户跟联系人的对象</span></span><br><span class="line">			Customer customer = <span class="keyword">new</span> Customer();</span><br><span class="line">			customer.setCustName(<span class="string">"小米公司"</span>);</span><br><span class="line">			customer.setCustLevel(<span class="string">"vip"</span>);</span><br><span class="line">			customer.setCustSource(<span class="string">"网络"</span>);</span><br><span class="line">			customer.setCustPhone(<span class="string">"15912138438"</span>);</span><br><span class="line">			customer.setCustMbile(<span class="string">"0394-700820"</span>);</span><br><span class="line">			</span><br><span class="line">			LinkMan linkman = <span class="keyword">new</span> LinkMan();</span><br><span class="line">			linkman.setLkm_name(<span class="string">"雷军"</span>);</span><br><span class="line">			linkman.setLkm_gender(<span class="string">"男"</span>);</span><br><span class="line">			linkman.setLkm_phone(<span class="string">"15932334335"</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//2.在客户表示联系人， 再联系人表示客户</span></span><br><span class="line">			<span class="comment">//建立客户对象和联系人对象关系</span></span><br><span class="line">			<span class="comment">//2.1把联系人对象梵高客户对象的set集合里面</span></span><br><span class="line">			customer.getSetLinkMan().add(linkman);</span><br><span class="line">			<span class="comment">//2.2把客户对象放到联系人里</span></span><br><span class="line">			linkman.setCustomer(customer);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//3.保存到数据库</span></span><br><span class="line">			session.save(customer);</span><br><span class="line">			session.save(linkman);</span><br><span class="line">			<span class="comment">//提交事务</span></span><br><span class="line">			</span><br><span class="line">			tx.commit();</span><br><span class="line">		&#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">			</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">			session.close();</span><br><span class="line">			sessionFactory.close();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p> （2）简单写法（一般根据客户添加联系人）</p>
<blockquote>
<p>​        第一步：在客户映射文件中进行配置：</p>
<p>​            在客户映射文件里面set标签进行配置</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"setLinkMan"</span> <span class="attr">cascade</span>=<span class="string">"save-update"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>​            第二步：创建客户跟联系人的对象，只需要把联系人放到客户里面就可以了，最总只需要保存客户就可以了</p>
<h6 id="一对多的级联删除"><a href="#一对多的级联删除" class="headerlink" title="一对多的级联删除"></a>一对多的级联删除</h6><ol>
<li><p>删除某个客户，把客户里面所有的联系人删除</p>
</li>
<li><p>具体实现：</p>
<p>第一步：在客户映射文件set标签， 进行配置</p>
<p>​    （1）使用属性cascade属性值 delete</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"setLinkMan"</span> <span class="attr">cascade</span>=<span class="string">"save-update, delete"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>第二步：在代码中直接删除代码</p>
<p>​    （1） 根据id查询对象，调用session里面delete方法删除</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 查询到客户id,调用session 的删除方法</span></span><br><span class="line">		Customer customer = session.get(Customer<span class="class">.<span class="keyword">class</span>, 7)</span>;</span><br><span class="line">		session.delete(customer);</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h6 id="一对多的修改操作"><a href="#一对多的修改操作" class="headerlink" title="一对多的修改操作"></a>一对多的修改操作</h6><ol>
<li><p>联系人所属客户更改</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//联系人所属客户更改</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testupdateDemo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	SessionFactory sessionFactory = <span class="keyword">null</span>;</span><br><span class="line">	Session session = <span class="keyword">null</span>;</span><br><span class="line">	Transaction tx = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		<span class="comment">//得到sessionfactory</span></span><br><span class="line">		sessionFactory = HibernateUtils.getSessionFactory();</span><br><span class="line">		<span class="comment">//本地线程绑定的session</span></span><br><span class="line">		session = sessionFactory.openSession();</span><br><span class="line">		<span class="comment">//开启事务</span></span><br><span class="line">		tx = session.beginTransaction();</span><br><span class="line">		<span class="comment">// 1. 查询到客户id查询到联系人，根据id查询到客户</span></span><br><span class="line">		Customer baidu = session.get(Customer<span class="class">.<span class="keyword">class</span>, 8)</span>;</span><br><span class="line">		LinkMan leijun =  session.get(LinkMan<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">		<span class="comment">//2.设置持久态</span></span><br><span class="line">		<span class="comment">//先把联系人放到客户里，</span></span><br><span class="line">		baidu.getSetLinkMan().add(leijun);</span><br><span class="line">		<span class="comment">//把客户放到联系人里</span></span><br><span class="line">		leijun.setCustomer(baidu);</span><br><span class="line">	</span><br><span class="line">		<span class="comment">//提交事务</span></span><br><span class="line">		</span><br><span class="line">		tx.commit();</span><br><span class="line">	&#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">		</span><br><span class="line">		tx.rollback();</span><br><span class="line">	&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">		session.close();</span><br><span class="line">		sessionFactory.close();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ol>
<ol start="2">
<li><p>inverse属性</p>
<p>（1）因为hibernate双向维护外键，在客户和联系人李米娜都需要维护外键，修改客户时候修改一次外键，修改联系人时候也修改一次外键，造成效率和性能的问题</p>
<p>（2）解决的方式：让其中的一方不维护外键</p>
<p>​    -一对多的里面，让其中 一 放弃外键维护</p>
<p>（3）具体实现</p>
<p>​    在放弃关系维护映射文件中，进行配置，在set标签上使用inverse属性</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--inverse属性默认值：false 不放弃关系维护</span></span><br><span class="line"><span class="comment">    					ture 放弃关系维护</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"setLinkMan"</span> <span class="attr">cascade</span>=<span class="string">"save-update,delete"</span> <span class="attr">inverse</span>=<span class="string">"true"</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h5 id="Hibernate多对多操作"><a href="#Hibernate多对多操作" class="headerlink" title="Hibernate多对多操作"></a>Hibernate多对多操作</h5><h6 id="多对多映射配置（用户和角色为例）"><a href="#多对多映射配置（用户和角色为例）" class="headerlink" title="多对多映射配置（用户和角色为例）"></a>多对多映射配置（用户和角色为例）</h6><p>第一步： 创建实体类，用户和角色</p>
<p>第二步： 让两个实体类之间相互表示</p>
<p>​    （1）用户里面表示所有角色， 使用set集合</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//一个用户可以有多个角色</span></span><br><span class="line"><span class="keyword">private</span> Set&lt;Role&gt; setRole = <span class="keyword">new</span> HashSet&lt;Role&gt;();</span><br><span class="line">	</span><br><span class="line"><span class="function"><span class="keyword">public</span> Set&lt;Role&gt; <span class="title">getSetRole</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> setRole;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSetRole</span><span class="params">(Set&lt;Role&gt; setRole)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.setRole = setRole;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​    （2）一个角色中表示多个用户， 使用set集合</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//一个角色表示多个用户</span></span><br><span class="line">	<span class="keyword">private</span> Set&lt;User&gt; setUser = <span class="keyword">new</span> HashSet&lt;User&gt;();</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Set&lt;User&gt; <span class="title">getSetUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> setUser;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSetUser</span><span class="params">(Set&lt;User&gt; setUser)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.setUser = setUser;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>第三步：配置映射关系</p>
<p>​    （1）基本配置</p>
<p>​    （2）配置多对多 关系</p>
<p>​        -在用户里面表示所有角色， 使用set标签</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 在用户映射文件中 ， 表示所有角色</span></span><br><span class="line"><span class="comment">    	使用set标签表示所有联系人</span></span><br><span class="line"><span class="comment">    	name属性：属性值写在客户实体类里面表示联系人的set集合名称</span></span><br><span class="line"><span class="comment">    	table属性：第三章表的名称</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"setRole"</span> <span class="attr">table</span>=<span class="string">"user_role"</span> &gt;</span></span><br><span class="line">    		<span class="comment">&lt;!--key 标签里面配置</span></span><br><span class="line"><span class="comment">    			配置当前映射文件在第三张表的外键名称</span></span><br><span class="line"><span class="comment">    		  --&gt;</span></span><br><span class="line">    		<span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"userid"</span>&gt;</span><span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    		<span class="comment">&lt;!-- class里面写联系人实体类全路径</span></span><br><span class="line"><span class="comment">    			column里面写角色在第三章外键的名称</span></span><br><span class="line"><span class="comment">    		--&gt;</span></span><br><span class="line">    		<span class="tag">&lt;<span class="name">many-to-many</span> <span class="attr">class</span>=<span class="string">"cn.itcast.manytomany.entity.Role"</span> <span class="attr">column</span>=<span class="string">"rileid"</span>&gt;</span><span class="tag">&lt;/<span class="name">many-to-many</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​        -在角色里面表示所有用户， 使用set标签</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 在角色映射文件中 ， 表示所有用户</span></span><br><span class="line"><span class="comment">    	使用set标签表示所有联系人</span></span><br><span class="line"><span class="comment">    	name属性：属性值写在客户实体类里面表示联系人的set集合名称</span></span><br><span class="line"><span class="comment">    		table属性：第三章表的名称</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"setUser"</span>  <span class="attr">table</span>=<span class="string">"user_role"</span>&gt;</span></span><br><span class="line">    		<span class="comment">&lt;!--key 标签里面配置</span></span><br><span class="line"><span class="comment">    			配置当前映射文件在第三张表的外键名称</span></span><br><span class="line"><span class="comment">    		  --&gt;</span></span><br><span class="line">    		<span class="tag">&lt;<span class="name">key</span> <span class="attr">column</span>=<span class="string">"roleid"</span>&gt;</span><span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">  				<span class="comment">&lt;!-- class里面写联系人实体类全路径</span></span><br><span class="line"><span class="comment">    			column里面写角色在第三章外键的名称</span></span><br><span class="line"><span class="comment">    		--&gt;</span></span><br><span class="line">    		<span class="tag">&lt;<span class="name">many-to-many</span> <span class="attr">class</span>=<span class="string">"cn.itcast.manytomany.entity.User"</span> <span class="attr">column</span>=<span class="string">"userid"</span>&gt;</span><span class="tag">&lt;/<span class="name">many-to-many</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>第四步：在核心配置文件中引入映射文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"cn/itcast/manytomany/entity/Role.hbm.xml"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">"cn/itcast/manytomany/entity/User.hbm.xml"</span>/&gt;</span></span><br></pre></td></tr></table></figure>



<h6 id="多对多级联保存"><a href="#多对多级联保存" class="headerlink" title="多对多级联保存"></a>多对多级联保存</h6><p>根据用户保存角色</p>
<p>第一步：在用户配置文件中set标签进行配置，cascade值save-update</p>
<p>第二步：写代码实现</p>
<p>（1）创建用户和角色对象，把角色放到用户里面，最终保存用户就可以；</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"setRole"</span> <span class="attr">table</span>=<span class="string">"user_role"</span>  <span class="attr">cascade</span>=<span class="string">"save-update"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testsaveDemo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		SessionFactory sessionFactory = <span class="keyword">null</span>;</span><br><span class="line">		Session session = <span class="keyword">null</span>;</span><br><span class="line">		Transaction tx = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//得到sessionfactory</span></span><br><span class="line">			sessionFactory = HibernateUtils.getSessionFactory();</span><br><span class="line">			<span class="comment">//本地线程绑定的session</span></span><br><span class="line">			session = sessionFactory.openSession();</span><br><span class="line">			<span class="comment">//开启事务</span></span><br><span class="line">			tx = session.beginTransaction();</span><br><span class="line">			<span class="comment">//添加两个用户， 为了每个用户添加两个角色</span></span><br><span class="line">			<span class="comment">//1.创建对象</span></span><br><span class="line">			User user1 = <span class="keyword">new</span> User();</span><br><span class="line">			user1.setUser_name(<span class="string">"lucy"</span>);</span><br><span class="line">			user1.setUser_password(<span class="string">"238575"</span>);</span><br><span class="line">			</span><br><span class="line">			User user2 = <span class="keyword">new</span> User();</span><br><span class="line">			user2.setUser_name(<span class="string">"mary"</span>);</span><br><span class="line">			user2.setUser_password(<span class="string">"233575"</span>);</span><br><span class="line">			</span><br><span class="line">			Role r1 = <span class="keyword">new</span> Role();</span><br><span class="line">			r1.setRole_name(<span class="string">"总经理"</span>);</span><br><span class="line">			r1.setRole_memo(<span class="string">"总经理"</span>);</span><br><span class="line">			</span><br><span class="line">			Role r2 = <span class="keyword">new</span> Role();</span><br><span class="line">			r2.setRole_name(<span class="string">"护士"</span>);</span><br><span class="line">			r2.setRole_memo(<span class="string">"护士"</span>);</span><br><span class="line">			</span><br><span class="line">			Role r3 = <span class="keyword">new</span> Role();</span><br><span class="line">			r3.setRole_name(<span class="string">"老师"</span>);</span><br><span class="line">			r3.setRole_memo(<span class="string">"老师"</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//2建立关系， 把角色放到用户里</span></span><br><span class="line">			<span class="comment">//user1 -- r1/r2</span></span><br><span class="line">			user1.getSetRole().add(r1);</span><br><span class="line">			user1.getSetRole().add(r2);</span><br><span class="line">		</span><br><span class="line">			<span class="comment">//user2 --r2 /r3</span></span><br><span class="line">			user2.getSetRole().add(r2);</span><br><span class="line">			user2.getSetRole().add(r3);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//3.保存用户</span></span><br><span class="line">			session.save(user1);</span><br><span class="line">			session.save(user2);</span><br><span class="line">			<span class="comment">//提交事务</span></span><br><span class="line">			</span><br><span class="line">			tx.commit();</span><br><span class="line">		&#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">			</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">			session.close();</span><br><span class="line">			sessionFactory.close();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h6 id="多对多级联删除"><a href="#多对多级联删除" class="headerlink" title="多对多级联删除"></a>多对多级联删除</h6><p>第一步：在set标签进行配置 ， cascade值delete</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">name</span>=<span class="string">"setRole"</span> <span class="attr">table</span>=<span class="string">"user_role"</span>  <span class="attr">casxmlcade</span>=<span class="string">"save-update,delete"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>第二步：删除用户</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User user1 = session.get(User<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">session.delete(user1);</span><br></pre></td></tr></table></figure>

<h6 id="维护第三张表关系"><a href="#维护第三张表关系" class="headerlink" title="维护第三张表关系"></a>维护第三张表关系</h6><ol>
<li><p>用户和角色多对多关系，维护关系通过第三张表维护</p>
</li>
<li><p>让某个用户有某个角色</p>
<p>第一步：根据id查询用户和角色</p>
<p>第二步：把角色放到用户里面</p>
<p>（1）把角色对象放到用户set集合</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//维护第三章表</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testTable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	SessionFactory sessionFactory = <span class="keyword">null</span>;</span><br><span class="line">	Session session = <span class="keyword">null</span>;</span><br><span class="line">	Transaction tx = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		<span class="comment">//得到sessionfactory</span></span><br><span class="line">		sessionFactory = HibernateUtils.getSessionFactory();</span><br><span class="line">		<span class="comment">//本地线程绑定的session</span></span><br><span class="line">		session = sessionFactory.openSession();</span><br><span class="line">		<span class="comment">//开启事务</span></span><br><span class="line">		tx = session.beginTransaction();</span><br><span class="line">		<span class="comment">//让某个用户有某个角色</span></span><br><span class="line">		<span class="comment">//让mary有校长的角色</span></span><br><span class="line">		<span class="comment">//1.查询出mary和校长</span></span><br><span class="line">		User lucy = session.get(User<span class="class">.<span class="keyword">class</span>, 3)</span>;</span><br><span class="line">		Role role = session.get(Role<span class="class">.<span class="keyword">class</span>, 6)</span>;</span><br><span class="line">		<span class="comment">//2.把角色放到用户的set集合里面</span></span><br><span class="line">		lucy.getSetRole().add(role);</span><br><span class="line">	</span><br><span class="line">		<span class="comment">//提交事务	</span></span><br><span class="line">		tx.commit();</span><br><span class="line">	&#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">		</span><br><span class="line">		tx.rollback();</span><br><span class="line">	&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">		session.close();</span><br><span class="line">		sessionFactory.close();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>让某个用户没有某个角色</p>
<p>第一步：根据id查询用户和角色</p>
<p>第二部：从用户里面把角色去掉</p>
<p>（1）从set集合里面把角色移除</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//维护第三章表:让某个用户没有某个角色</span></span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testTableNo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		SessionFactory sessionFactory = <span class="keyword">null</span>;</span><br><span class="line">		Session session = <span class="keyword">null</span>;</span><br><span class="line">		Transaction tx = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="comment">//得到sessionfactory</span></span><br><span class="line">			sessionFactory = HibernateUtils.getSessionFactory();</span><br><span class="line">			<span class="comment">//本地线程绑定的session</span></span><br><span class="line">			session = sessionFactory.openSession();</span><br><span class="line">			<span class="comment">//开启事务</span></span><br><span class="line">			tx = session.beginTransaction();</span><br><span class="line">			<span class="comment">//让某个用户没有某个角色			</span></span><br><span class="line">			User lucy = session.get(User<span class="class">.<span class="keyword">class</span>, 3)</span>;</span><br><span class="line">			Role role = session.get(Role<span class="class">.<span class="keyword">class</span>, 6)</span>;</span><br><span class="line">			<span class="comment">//2.从用户里面移除角色</span></span><br><span class="line">			lucy.getSetRole().remove(role);</span><br><span class="line">		</span><br><span class="line">			<span class="comment">//提交事务	</span></span><br><span class="line">			tx.commit();</span><br><span class="line">		&#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">			</span><br><span class="line">			tx.rollback();</span><br><span class="line">		&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">			session.close();</span><br><span class="line">			sessionFactory.close();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h5 id="Hibernate查询方式"><a href="#Hibernate查询方式" class="headerlink" title="Hibernate查询方式"></a>Hibernate查询方式</h5><blockquote>
<ol>
<li><p>对象导航查询</p>
<p>(1)根据ID查询某个客户， 再查询客户里面的缪个联系人</p>
</li>
<li><p>OID查询</p>
<p>（1）根据ID查询的某一条记录， 返回对象</p>
</li>
<li><p>hql查询</p>
<p>（1）Query对象， 写hql语句实现查询</p>
</li>
</ol>
<p>​    4. QBC查询</p>
<p>​        （1）Criteria对象    </p>
<p>​    5. 本地sql查询</p>
<p>​        （1）SQLQuery对象， 使用普通sql实现查询</p>
</blockquote>
<h6 id="对象导航查询"><a href="#对象导航查询" class="headerlink" title="对象导航查询"></a>对象导航查询</h6><ol>
<li><p>查询某个客户里面所有联系人过程，实现对象导航实现</p>
</li>
<li><p>代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据cid=1的客户， 在查询这个客户里面所有的联系人</span></span><br><span class="line">		Customer customer = session.get(Customer<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br><span class="line">		<span class="comment">//再查询这个客户里面的所有联系人</span></span><br><span class="line">		<span class="comment">//直接得到客户里面的set集合</span></span><br><span class="line">		Set&lt;LinkMan&gt; linkman = customer.getSetLinkMan();</span><br><span class="line">		System.out.println(linkman.size());</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h6 id="OID查询"><a href="#OID查询" class="headerlink" title="OID查询"></a>OID查询</h6><ol>
<li><p>根据id查询记录</p>
<p>（1）调用session里面的get方法实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据cid=1的客户， 在查询这个客户里面所有的联系人</span></span><br><span class="line">			Customer customer = session.get(Customer<span class="class">.<span class="keyword">class</span>, 1)</span>;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h6 id="HQL查询"><a href="#HQL查询" class="headerlink" title="HQL查询"></a>HQL查询</h6><ol>
<li><p>hql：hibernate query language , hibernate提供一种查询语言， hql语言和普通sql很相似，</p>
<p>区别：普通sql操作数据库表和字段，hql操作实体类和属性</p>
</li>
<li><p>常用的hql语句</p>
<p>（1）查询所有：from实体类名称</p>
</li>
<li><p>使用hql查询操作的时候， 使用Query对象</p>
<p>​    （1）创建Query对象， 写hql语句</p>
<p>​    （2）调用query对象里面的方法得到结果</p>
</li>
</ol>
<h6 id="查询所有"><a href="#查询所有" class="headerlink" title="查询所有"></a>查询所有</h6><ol>
<li><p>查询所有的客户记录</p>
<p>（1）创建Query对象， 写hql语句</p>
<p>（2）调用query对象里面的方法得到结果</p>
</li>
<li><p>查询所有：from实体类名称</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建query对象</span></span><br><span class="line">		Query query = session.createQuery(<span class="string">"from Customer"</span>);</span><br><span class="line">	<span class="comment">//2.调用方法得到结果</span></span><br><span class="line">		List&lt;Customer&gt; list =query.list();</span><br><span class="line">		<span class="keyword">for</span> (Customer customer : list) &#123;</span><br><span class="line">			System.out.println(customer.getCid()+<span class="string">"::"</span>+customer.getCustName());</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<h6 id="条件查询"><a href="#条件查询" class="headerlink" title="条件查询"></a>条件查询</h6><ol>
<li><p>hql条件查询语句写法</p>
<p>（1）from 实体类名称 where 实体类属性名称=？and 实体类属性名称=？</p>
<p>from 实体类名称 where 实体类属性名称 like ？</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建query对象</span></span><br><span class="line">				Query query = session.createQuery(<span class="string">"from Customer c where c.cid=? and c.custName=?"</span>);</span><br><span class="line">			<span class="comment">//2.设置条件的值（向?里面设置值）</span></span><br><span class="line">				<span class="comment">//setParameter(1, arg1):第一个参数：int类型是？位置</span></span><br><span class="line">				<span class="comment">//						第二个参数：具体参数值</span></span><br><span class="line">				query.setParameter(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">				query.setParameter(<span class="number">1</span>, <span class="string">"小米公司"</span>);</span><br><span class="line">				<span class="comment">//3.调用放大得到结果</span></span><br><span class="line">				List&lt;Customer&gt; list = query.list();</span><br><span class="line">				<span class="keyword">for</span> (Customer customer : list) &#123;</span><br><span class="line">					System.out.println(customer.getCid()+<span class="string">"::"</span>+customer.getCustName());</span><br><span class="line">				&#125;</span><br></pre></td></tr></table></figure>

<p>模糊查询</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建query对象</span></span><br><span class="line">					Query query = session.createQuery(<span class="string">"from Customer where custName like ?"</span>);</span><br><span class="line">				<span class="comment">//2.设置条件的值（向?里面设置值）</span></span><br><span class="line">					<span class="comment">//%米%</span></span><br><span class="line">					query.setParameter(<span class="number">0</span>, <span class="string">"%米%"</span>);</span><br><span class="line">					<span class="comment">//3.调用放法得到结果</span></span><br><span class="line">					List&lt;Customer&gt; list = query.list();</span><br><span class="line">					<span class="keyword">for</span> (Customer customer : list) &#123;</span><br><span class="line">						System.out.println(customer.getCid()+<span class="string">"::"</span>+customer.getCustName());</span><br><span class="line">					&#125;</span><br></pre></td></tr></table></figure>

<h6 id="排序查询"><a href="#排序查询" class="headerlink" title="排序查询"></a>排序查询</h6><ol>
<li><p>hql排序语句写法</p>
<p>（1）from 实体类名称 order by 实体类属性名称 asc/desc</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建query对象</span></span><br><span class="line">		Query query = session.createQuery(<span class="string">"from Customer order by cid desc"</span>);</span><br><span class="line"><span class="comment">//asc：升序</span></span><br><span class="line"><span class="comment">//desc ：降序</span></span><br><span class="line">	</span><br><span class="line">		<span class="comment">//2.调用放法得到结果</span></span><br><span class="line">		List&lt;Customer&gt; list = query.list();</span><br><span class="line">		<span class="keyword">for</span> (Customer customer : list) &#123;</span><br><span class="line">			System.out.println(customer.getCid()+<span class="string">"::"</span>+customer.getCustName());</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h6 id="分页查询"><a href="#分页查询" class="headerlink" title="分页查询"></a>分页查询</h6><ol>
<li><p>mysql 实现分页：关键字：limit</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM tb_customer LIMIT 0,3;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在hql操作中， 在语句里面不能写limit，hibernate的Query对象封装两个方法实现分页操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建query对象</span></span><br><span class="line">				<span class="comment">//写查询所有的</span></span><br><span class="line">				Query query = session.createQuery(<span class="string">"from Customer"</span>);</span><br><span class="line">			<span class="comment">//2.设置分页数据</span></span><br><span class="line">				<span class="comment">//2.1设置开始位置</span></span><br><span class="line">				query.setFirstResult(<span class="number">0</span>);</span><br><span class="line">				<span class="comment">//2.2设置每页显示记录数</span></span><br><span class="line">				query.setMaxResults(<span class="number">3</span>);</span><br><span class="line">				<span class="comment">//3.调用放法得到结果</span></span><br><span class="line">				List&lt;Customer&gt; list = query.list();</span><br><span class="line">				<span class="keyword">for</span> (Customer customer : list) &#123;</span><br><span class="line">					System.out.println(customer.getCid()+<span class="string">"::"</span>+customer.getCustName());</span><br><span class="line">				&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h6 id="投影查询"><a href="#投影查询" class="headerlink" title="投影查询"></a>投影查询</h6><ol>
<li><p>投影查询：查询部分字段的值</p>
</li>
<li><p>投影查询的hql语句的写法</p>
<p>（1）select 实体类属性名称1， 实体类属性名称2 from 实体类名称（select后面不能写 * ， 不支持）</p>
</li>
<li><p>具体实现</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建query对象</span></span><br><span class="line">				Query query = session.createQuery(<span class="string">"select custName from Customer"</span>);</span><br><span class="line">				<span class="comment">//调用方法得到结果</span></span><br><span class="line">				List&lt;Object&gt; list = query.list();</span><br><span class="line">				<span class="keyword">for</span> (Object object : list) &#123;</span><br><span class="line">					System.out.println(object);</span><br><span class="line">				&#125;</span><br></pre></td></tr></table></figure>

<h6 id="聚集函数使用"><a href="#聚集函数使用" class="headerlink" title="聚集函数使用"></a>聚集函数使用</h6><ol>
<li><p>常用的聚集函数</p>
<p>（1）count，sum,  avg,  max,  min</p>
</li>
<li><p>hql聚集函数语句写法</p>
<p>（1）查询表记录数：select count(*) from 实体类名称</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建query对象</span></span><br><span class="line">		Query query = session.createQuery(<span class="string">"select count(*) from Customer"</span>);</span><br><span class="line">		<span class="comment">//2.调用方法得到结果</span></span><br><span class="line">		<span class="comment">//query对象里面有方法直接返回形式</span></span><br><span class="line">		Object obj = query.uniqueResult();</span><br><span class="line">		<span class="comment">//返回int类型</span></span><br><span class="line">		Long lobj = (Long)obj;</span><br><span class="line">		<span class="keyword">int</span> count = lobj.intValue();</span><br><span class="line">		System.out.println(count);</span><br></pre></td></tr></table></figure>

<h5 id="QBC查询"><a href="#QBC查询" class="headerlink" title="QBC查询"></a>QBC查询</h5><ol>
<li>使用hql查询需要写hql语句实现， 但是使用qbc的时候，不需要写语句了，使用方法是实现查询</li>
</ol>
<h6 id="查询所有-1"><a href="#查询所有-1" class="headerlink" title="查询所有"></a>查询所有</h6><ol>
<li>创建Criteria对象</li>
<li>调用方法得到结果</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建Criteria对象</span></span><br><span class="line">	Criteria criteria = session.createCriteria(Customer<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">	<span class="comment">//2.调用方法得到结果</span></span><br><span class="line"></span><br><span class="line">		List&lt;Customer&gt; list =	criteria.list();</span><br><span class="line">		<span class="keyword">for</span> (Customer customer : list) &#123;</span><br><span class="line">			System.out.println(customer.getCid()+<span class="string">"::"</span>+customer.getCustName());</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<h6 id="条件查询-1"><a href="#条件查询-1" class="headerlink" title="条件查询"></a>条件查询</h6><ol>
<li>没有语句，使用封装的方法来实现</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建Criteria对象</span></span><br><span class="line">			Criteria criteria = session.createCriteria(Customer<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		<span class="comment">//2.使用Criteria对象里面的方法设置条件值</span></span><br><span class="line">			<span class="comment">//首先要使用add方法， 表示设置条件值</span></span><br><span class="line">			<span class="comment">//在add方法里面使用类的方法实现条件设置</span></span><br><span class="line">			<span class="comment">//类似于cid=?</span></span><br><span class="line">			criteria.add(Restrictions.eq(<span class="string">"cid"</span>, <span class="number">1</span>));</span><br><span class="line">			criteria.add(Restrictions.eq(<span class="string">"custName"</span>, <span class="string">"小米公司"</span>));</span><br><span class="line"><span class="comment">//模糊查询	</span></span><br><span class="line"><span class="comment">//criteria.add(Restrictions.like("custName", "%公%"));</span></span><br><span class="line">			<span class="comment">//3.调用方法得到结果</span></span><br><span class="line">			List&lt;Customer&gt; list = criteria.list();</span><br><span class="line">			<span class="keyword">for</span> (Customer customer : list) &#123;</span><br><span class="line">				System.out.println(customer.getCid()+<span class="string">"::"</span>+customer.getCustName());</span><br><span class="line">			&#125;</span><br></pre></td></tr></table></figure>
<h6 id="排序查询-1"><a href="#排序查询-1" class="headerlink" title="排序查询"></a>排序查询</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建Criteria对象</span></span><br><span class="line">			Criteria criteria = session.createCriteria(Customer<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">			<span class="comment">//criteria.addOrder(Order.asc("cid"));//升序</span></span><br><span class="line">			criteria.addOrder(Order.desc(<span class="string">"cid"</span>));<span class="comment">//降序</span></span><br><span class="line">			<span class="comment">//2.调用放法得到结果</span></span><br><span class="line">			List&lt;Customer&gt; list = criteria.list();</span><br><span class="line">			<span class="keyword">for</span> (Customer customer : list) &#123;</span><br><span class="line">				System.out.println(customer.getCid()+<span class="string">"::"</span>+customer.getCustName());</span><br><span class="line">			&#125;</span><br></pre></td></tr></table></figure>

<h6 id="分页查询-1"><a href="#分页查询-1" class="headerlink" title="分页查询"></a>分页查询</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建Criteria对象</span></span><br><span class="line">				<span class="comment">//写查询所有的</span></span><br><span class="line">				Criteria criteria = session.createCriteria(Customer<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">			<span class="comment">//2.设置分页数据</span></span><br><span class="line">				<span class="comment">//2.1设置开始位置</span></span><br><span class="line">				criteria.setFirstResult(<span class="number">0</span>);</span><br><span class="line">				<span class="comment">//2.2设置每页显示记录数</span></span><br><span class="line">				criteria.setMaxResults(<span class="number">3</span>);</span><br><span class="line">				<span class="comment">//3.调用放法得到结果</span></span><br><span class="line">				List&lt;Customer&gt; list = criteria.list();</span><br><span class="line">				<span class="keyword">for</span> (Customer customer : list) &#123;</span><br><span class="line">					System.out.println(customer.getCid()+<span class="string">"::"</span>+customer.getCustName());</span><br><span class="line">				&#125;</span><br></pre></td></tr></table></figure>

<p>开始位置计算公式：（当前页-1）*每页记录数</p>
<h6 id="统计查询"><a href="#统计查询" class="headerlink" title="统计查询"></a>统计查询</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建Criteria对象</span></span><br><span class="line">				Criteria criteria = session.createCriteria(Customer<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">				<span class="comment">//2.设置操作</span></span><br><span class="line">				criteria.setProjection(Projections.rowCount());</span><br><span class="line">				<span class="comment">//3.调用放法得到结果</span></span><br><span class="line">				Object obj = criteria.uniqueResult();</span><br><span class="line">				Long lobj = (Long)obj;</span><br><span class="line">				<span class="keyword">int</span> count = lobj.intValue();</span><br><span class="line">				System.out.println(count);</span><br></pre></td></tr></table></figure>

<h6 id="离线查询"><a href="#离线查询" class="headerlink" title="离线查询"></a>离线查询</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建对象</span></span><br><span class="line">			DetachedCriteria detachedCriteria = DetachedCriteria.forClass(Customer<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">			</span><br><span class="line">		<span class="comment">//2.最终执行时候才需要拿到dession	</span></span><br><span class="line">			Criteria criteria = detachedCriteria.getExecutableCriteria(session);</span><br><span class="line">			List&lt;Customer&gt; list = criteria.list();</span><br><span class="line">			<span class="keyword">for</span> (Customer customer : list) &#123;</span><br><span class="line">				System.out.println(customer.getCid()+<span class="string">"::"</span>+customer.getCustName());</span><br><span class="line">			&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>离线查询的场景：servlet 调用service， service调用dao</p>
<p>（1）在dao里面对数据库crud操作</p>
<p>（2）在dao里面使用hibernate框架，使用hibernate框架的时候， 调用session里面的方法实现功能    </p>
</li>
</ol>
<h5 id="HQL-多表查询"><a href="#HQL-多表查询" class="headerlink" title="HQL 多表查询"></a>HQL 多表查询</h5><p>Mysql里面多表查询</p>
<p>1.内连接</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from tb_customer,tb_linkman where cid &#x3D; clid;</span><br><span class="line">SELECT * from tb_customer c INNER JOIN tb_linkman l ON c.cid&#x3D;l.clid;</span><br></pre></td></tr></table></figure>

<p>2.左外连接</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM tb_customer c LEFT JOIN tb_linkman l ON c.cid&#x3D;l.clid;</span><br></pre></td></tr></table></figure>

<p>3.右外连接</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM tb_customer c RIGHT JOIN tb_linkman l ON c.cid&#x3D;l.clid;</span><br></pre></td></tr></table></figure>

<h5 id="HQL中实现多表查询"><a href="#HQL中实现多表查询" class="headerlink" title="HQL中实现多表查询"></a>HQL中实现多表查询</h5><blockquote>
<p>内连接</p>
<p>（1） 写法：from Customer c inner join c.setLinkMan</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建query对象</span></span><br><span class="line">		Query query = session.createQuery(<span class="string">"from Customer c inner join c.setLinkMan"</span>);</span><br><span class="line">		<span class="comment">//调用方法得到结果</span></span><br><span class="line">		List list = query.list();</span><br></pre></td></tr></table></figure>

<blockquote>
<p>左外连接</p>
</blockquote>
<blockquote>
<p>右外连接</p>
</blockquote>
<blockquote>
<p>迫切内连接</p>
<p>(1)迫切内连接和内连接底层实现一样的</p>
<p>区别：使用内连接返回list中每部分是数组，迫切内连接返回的list每部分是对象</p>
<p>（2）from Customer c inner join fetch c.setLinkMan</p>
</blockquote>
<blockquote>
<p>迫切左外连接</p>
</blockquote>

  </div>
  <!--文末结束语-->
  
    <div style="text-align:center;color: #ccc;font-size:24px;"> --- 本文结束 <i class="iconfont icon-heartbeat" style="font-size:24px;"></i> The End --- </div>
  
  <!--页脚广告-->
  
  <div class="mdui-divider"></div>
  
  <nav>
    
    
      <a rel="next" class="post-nav-item mdui-float-right" href="/2020/04/19/struts2/">
        <span>struts2</span>
        <i class="iconfont icon-angle-right"></i>
      </a>
    
  </nav>
</article>




  <div class="toc-button"  style="z-index: 100;">
    <button class="mdui-fab mdui-ripple mdui-color-teal" mdui-menu="{target: '#toc'}"><i class="iconfont icon-list"></i></button>
    <ul class="mdui-menu" id="toc">
      <li class="mdui-menu-item">
        <a href="/2020/05/17/Hibernate/" id="toc-header" class="mdui-ripple">文章目录</a>
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hibernate概述"><span class="toc-number">1.</span> <span class="toc-text">Hibernate概述</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Hibernate版本："><span class="toc-number">1.0.0.1.</span> <span class="toc-text">Hibernate版本：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#什么是ORM思想"><span class="toc-number">1.0.0.2.</span> <span class="toc-text">什么是ORM思想</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Hibernate入门"><span class="toc-number">1.0.0.3.</span> <span class="toc-text">Hibernate入门</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#实现添加操作"><span class="toc-number">1.0.0.4.</span> <span class="toc-text">实现添加操作</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Hibernate配置文件详解"><span class="toc-number">1.0.1.</span> <span class="toc-text">Hibernate配置文件详解</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Hibernate映射配置文件"><span class="toc-number">1.0.1.1.</span> <span class="toc-text">Hibernate映射配置文件</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Hibernate核心配置文件"><span class="toc-number">1.0.1.2.</span> <span class="toc-text">Hibernate核心配置文件</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Hibernate-核心api"><span class="toc-number">1.0.2.</span> <span class="toc-text">Hibernate 核心api</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Configuration"><span class="toc-number">1.0.2.1.</span> <span class="toc-text">Configuration</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#SessionFactory"><span class="toc-number">1.0.2.2.</span> <span class="toc-text">SessionFactory</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Session"><span class="toc-number">1.0.2.3.</span> <span class="toc-text">Session</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#实体类的编写规则："><span class="toc-number">1.0.2.4.</span> <span class="toc-text">实体类的编写规则：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Hibernate-主键生成策略"><span class="toc-number">1.0.2.5.</span> <span class="toc-text">Hibernate 主键生成策略</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#实体类操作"><span class="toc-number">1.0.3.</span> <span class="toc-text">实体类操作</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#对实体类的crud操作"><span class="toc-number">1.0.3.1.</span> <span class="toc-text">对实体类的crud操作</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#实体类对象状态（概念）"><span class="toc-number">1.0.3.2.</span> <span class="toc-text">实体类对象状态（概念）</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Hibernate-的一级的缓存"><span class="toc-number">1.0.4.</span> <span class="toc-text">Hibernate 的一级的缓存</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#什么是缓存？"><span class="toc-number">1.0.4.1.</span> <span class="toc-text">什么是缓存？</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Hibernate缓存"><span class="toc-number">1.0.4.2.</span> <span class="toc-text">Hibernate缓存</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Hibernate事务操作"><span class="toc-number">1.0.5.</span> <span class="toc-text">Hibernate事务操作</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#事务相关概念"><span class="toc-number">1.0.5.1.</span> <span class="toc-text">事务相关概念</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Hibernate事务代码规范写法"><span class="toc-number">1.0.5.2.</span> <span class="toc-text">Hibernate事务代码规范写法</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Hibernate绑定session"><span class="toc-number">1.0.5.3.</span> <span class="toc-text">Hibernate绑定session</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Hibernate的api使用"><span class="toc-number">1.0.6.</span> <span class="toc-text">Hibernate的api使用</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Query对象"><span class="toc-number">1.0.6.1.</span> <span class="toc-text">Query对象</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Criteria对象"><span class="toc-number">1.0.6.2.</span> <span class="toc-text">Criteria对象</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#SQLQuery对象"><span class="toc-number">1.0.6.3.</span> <span class="toc-text">SQLQuery对象</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#表与表之间的关系"><span class="toc-number">1.0.6.4.</span> <span class="toc-text">表与表之间的关系</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Hibernate的一对多操作"><span class="toc-number">1.0.7.</span> <span class="toc-text">Hibernate的一对多操作</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#一对多映射配置"><span class="toc-number">1.0.7.1.</span> <span class="toc-text">一对多映射配置</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#一对多级联操作"><span class="toc-number">1.0.7.2.</span> <span class="toc-text">一对多级联操作</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#一对多的级联保存"><span class="toc-number">1.0.7.3.</span> <span class="toc-text">一对多的级联保存</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#一对多的级联删除"><span class="toc-number">1.0.7.4.</span> <span class="toc-text">一对多的级联删除</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#一对多的修改操作"><span class="toc-number">1.0.7.5.</span> <span class="toc-text">一对多的修改操作</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Hibernate多对多操作"><span class="toc-number">1.0.8.</span> <span class="toc-text">Hibernate多对多操作</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#多对多映射配置（用户和角色为例）"><span class="toc-number">1.0.8.1.</span> <span class="toc-text">多对多映射配置（用户和角色为例）</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#多对多级联保存"><span class="toc-number">1.0.8.2.</span> <span class="toc-text">多对多级联保存</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#多对多级联删除"><span class="toc-number">1.0.8.3.</span> <span class="toc-text">多对多级联删除</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#维护第三张表关系"><span class="toc-number">1.0.8.4.</span> <span class="toc-text">维护第三张表关系</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Hibernate查询方式"><span class="toc-number">1.0.9.</span> <span class="toc-text">Hibernate查询方式</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#对象导航查询"><span class="toc-number">1.0.9.1.</span> <span class="toc-text">对象导航查询</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#OID查询"><span class="toc-number">1.0.9.2.</span> <span class="toc-text">OID查询</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#HQL查询"><span class="toc-number">1.0.9.3.</span> <span class="toc-text">HQL查询</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#查询所有"><span class="toc-number">1.0.9.4.</span> <span class="toc-text">查询所有</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#条件查询"><span class="toc-number">1.0.9.5.</span> <span class="toc-text">条件查询</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#排序查询"><span class="toc-number">1.0.9.6.</span> <span class="toc-text">排序查询</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#分页查询"><span class="toc-number">1.0.9.7.</span> <span class="toc-text">分页查询</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#投影查询"><span class="toc-number">1.0.9.8.</span> <span class="toc-text">投影查询</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#聚集函数使用"><span class="toc-number">1.0.9.9.</span> <span class="toc-text">聚集函数使用</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#QBC查询"><span class="toc-number">1.0.10.</span> <span class="toc-text">QBC查询</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#查询所有-1"><span class="toc-number">1.0.10.1.</span> <span class="toc-text">查询所有</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#条件查询-1"><span class="toc-number">1.0.10.2.</span> <span class="toc-text">条件查询</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#排序查询-1"><span class="toc-number">1.0.10.3.</span> <span class="toc-text">排序查询</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#分页查询-1"><span class="toc-number">1.0.10.4.</span> <span class="toc-text">分页查询</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#统计查询"><span class="toc-number">1.0.10.5.</span> <span class="toc-text">统计查询</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#离线查询"><span class="toc-number">1.0.10.6.</span> <span class="toc-text">离线查询</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#HQL-多表查询"><span class="toc-number">1.0.11.</span> <span class="toc-text">HQL 多表查询</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#HQL中实现多表查询"><span class="toc-number">1.0.12.</span> <span class="toc-text">HQL中实现多表查询</span></a></li></ol></li></ol></li></ol>
      </li>
    </ul>
  </div>



    <div id="comment" class="mdui-card mdui-p-a-2 mdui-m-b-5">
      <div class="mdui-tab" mdui-tab>
        
          <a href="#comment-tab0" class="mdui-ripple">gitalk</a>
        
          <a href="#comment-tab1" class="mdui-ripple">livere</a>
        
      </div>
      
        <div id="comment-tab0" class="mdui-p-a-2">
          <div id="gitalk-container"></div>
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/js-md5@0.7.3/src/md5.min.js"></script>
<script>
  var gitalk = new Gitalk({
    clientID: '',
    clientSecret: '',
    repo: '',
    owner: '',
    admin: [''],
    id:  md5(location.pathname) ,
    distractionFreeMode: 'true',
  });
  gitalk.render('gitalk-container');
</script>
        </div>
      
        <div id="comment-tab1" class="mdui-p-a-2">
          <div id="lv-container" data-id="city" data-uid="">
  <script type="text/javascript">
    (function (d, s) {
      var j, e = d.getElementsByTagName(s)[0];
      if (typeof LivereTower === 'function') { return; }
      j = d.createElement(s);
      j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
      j.async = true;
      e.parentNode.insertBefore(j, e);
    })(document, 'script');
  </script>
  <noscript>Please enable JavaScript to view the comments powered by LiveRe.</noscript>
</div>
        </div>
      
    </div>

  </main>
  <footer id="footer" class="mdui-text-center mdui-m-t-5 mdui-p-b-2 mdui-p-t-4 mdui-color-theme">
  <div class="mdui-container">
    <div class="mdui-row">
      
        <a href="http://www.beian.miit.gov.cn" rel="noopener" target="_blank"></a>
      
      <span>
        &copy; 2015 - 2020 
        
          <span style="color:#d9333f" class="iconfont icon-heart"></span>
        
        ZhengXingfu
      </span>
    </div>
    <div class="mdui-row">
      
        <div class="mdui-col-xs-6 mdui-text-right">
          <span>Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a></span>
        </div>
        <div class="mdui-col-xs-6 mdui-text-left">
          <span>Theme: <a href="https://github.com/kb1000fx/Meadow" rel="noopener" target="_blank">Meadow</a></span>
        </div>
      
    </div>
    <div class="mdui-row">
      
        <div class="mdui-col-xs-6 mdui-text-right">
          <span id="busuanzi_container_site_uv" style="display: none;"> <span class="iconfont icon-user"></span>总访客量 <span id="busuanzi_value_site_uv"></span></span>
        </div>
        <div class="mdui-col-xs-6 mdui-text-left">
          <span id="busuanzi_container_site_pv" style="display: none;"> <span class="iconfont icon-eye"></span>总访问量 <span id="busuanzi_value_site_pv"></span></span>
        </div>
      
    </div>
 </div>
</footer>
  
  <button id="gotop" class="mdui-fab mdui-fab-fixed mdui-fab-hide mdui-ripple mdui-color-teal" style="z-index:100;"><i class="iconfont icon-arrowup"></i></button>
  
  

    <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




    <script src="https://cdn.jsdelivr.net/npm/mermaid@8.4.8/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({
        startOnLoad: true,
        theme: "default"
    });</script>




<script src="/js/mdui.min.js"></script>
<script src="/js/meadow.js"></script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/miku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html >